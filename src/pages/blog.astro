---
import { getCollection } from 'astro:content';
import Base from '../Base.astro';
import SVGIcon from '../components/SVGIcon.astro';
import PostList from '../components/blog/PostListRenderer';
import SortMode from '../components/blog/SortMode';
import SearchBar from '../components/blog/SearchBar';

// TODO: viewmodes tsx component
// TODO: mobile support

const posts = await getCollection(`blog`);

---

<Base title="blog">
	<div class="wrapper large">
		<aside class="contentBox">
			<SearchBar client:load />
			<SortMode client:load />
			<div class="viewModes">
				<label>
					<SVGIcon src="/icons/layout-grid.svg" />
					<input type="radio" name="viewMode" autocomplete="off" />
				</label>
				<label>
					<SVGIcon src="/icons/layout-list.svg" />
					<input type="radio" name="viewMode" autocomplete="off" checked />
				</label>
				<label>
					<SVGIcon src="/icons/layout-dashboard.svg" />
					<input type="radio" name="viewMode" autocomplete="off" />
				</label>
			</div>
		</aside>

		<PostList postData={posts} client:load />
	</div>
</Base>

<style lang="scss">
	.wrapper {
		display: flex;
		flex-direction: column;
		align-items: flex-start;
		gap: var(--inner-void-gap);
	}

	$ud-pad: 0.5rem;

	aside {
		display: flex;
		gap: var(--inner-void-gap);
		width: 100%;
		padding: calc(var(--edge-pad) / 2);

		.viewModes {
			display: flex;
			align-items: center;
			justify-content: center;
			gap: var(--inner-void-gap);
			margin-left: auto;

			label {
				display: flex;
				align-items: center;
				justify-content: center;
				background-color: var(--secondary-box-bg);
				width: auto;
				height: 100%;
				aspect-ratio: 1;

				&:has(input:checked) {
					background-color: var(--trim);
					color: var(--box-bg);
				}
			}

			input {
				display: none;
			}
		}
	}
</style>